(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     63558,       1746]
NotebookOptionsPosition[     59536,       1670]
NotebookOutlinePosition[     59968,       1687]
CellTagsIndexPosition[     59925,       1684]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Multipolar Expansion", "Title",
 CellChangeTimes->{{3.8654835547371607`*^9, 
  3.86548357007966*^9}},ExpressionUUID->"baff7555-b9e6-4628-8fdd-\
8b769f1a5051"],

Cell[BoxData[
 RowBox[{
  RowBox[{"isBuiltIn", "[", "s_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Context", "[", 
    RowBox[{"Evaluate", "@", 
     RowBox[{"Head", "@", "s"}]}], "]"}], "===", 
   "\"\<System`\>\""}]}]], "Input",
 CellChangeTimes->{{3.883675470423965*^9, 3.883675470427388*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"47f5daae-a3d8-4104-aae2-b42a037d0857"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myOp", "[", 
   RowBox[{"Plus", "[", 
    RowBox[{"f_", ",", " ", "g_"}], "]"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"myOp", "[", "f", "]"}], " ", "+", " ", 
   RowBox[{"myOp", "[", "g", "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"myOp", "[", 
   RowBox[{
    RowBox[{"a_", "?", "isBuiltIn"}], " ", 
    RowBox[{"f_", "[", 
     RowBox[{"x_", ",", " ", "t_"}], "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"a", " ", 
   RowBox[{"myOp", "[", 
    RowBox[{"f", "[", 
     RowBox[{"x", ",", " ", "t"}], "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.883675513548414*^9, 3.883675513550804*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"73f1a499-2fd8-4b0b-8930-d61041b097ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"a___", "\[CenterDot]", 
        RowBox[{"(", 
         RowBox[{"b_", "\[CenterDot]", "c_"}], ")"}], "\[CenterDot]", 
        "d___"}], "/;", 
       RowBox[{"NumericQ", "[", "b", "]"}]}], ":>", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{"a", "\[CenterDot]", "c", "\[CenterDot]", "d"}], ")"}]}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"a___", "\[CenterDot]", 
        RowBox[{"(", 
         RowBox[{"b_", " ", "c_"}], ")"}], "\[CenterDot]", "d___"}], "/;", 
       RowBox[{"NumericQ", "[", "b", "]"}]}], ":>", 
      RowBox[{"b", 
       RowBox[{"(", 
        RowBox[{"a", "\[CenterDot]", "c", "\[CenterDot]", "d"}], ")"}]}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a___", "\[CenterDot]", 
       RowBox[{"(", 
        RowBox[{"b_", "+", "c_"}], ")"}], "\[CenterDot]", "d___"}], ":>", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", "b", "\[CenterDot]", "d"}], "+", 
       RowBox[{"a", "\[CenterDot]", "c", "\[CenterDot]", "d"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"b_", "\[CenterDot]", "c_"}], "/;", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}], "]"}], "=!=", 
        RowBox[{"{", 
         RowBox[{"b", ",", "c"}], "}"}]}]}], ":>", 
      RowBox[{"c", "\[CenterDot]", "b"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CenterDot", "[", "a_", "]"}], ":>", "a"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.865483853778816*^9, 3.865483984514991*^9}, {
  3.8654844680556498`*^9, 3.865484539047721*^9}, {3.865484583048909*^9, 
  3.865484628536212*^9}, {3.86548466471276*^9, 3.865484682808568*^9}, {
  3.8654847837055883`*^9, 3.865484821241377*^9}, {3.8654848745385523`*^9, 
  3.865484874681549*^9}, {3.865485381997056*^9, 3.865485459148705*^9}, {
  3.865485494494356*^9, 3.86548550108599*^9}, {3.8654861323065147`*^9, 
  3.8654861390256577`*^9}, {3.86548620670756*^9, 3.865486260866721*^9}, {
  3.865486502311286*^9, 3.865486550645041*^9}, {3.86548658322225*^9, 
  3.8654866497654667`*^9}, {3.88367388903976*^9, 3.883673890733684*^9}, {
  3.8836739986498823`*^9, 3.883673998991137*^9}, {3.8836743946730633`*^9, 
  3.8836744139844027`*^9}, {3.883674451646121*^9, 3.883674480827335*^9}, {
  3.883674817232794*^9, 3.883674850686328*^9}, {3.8836748899376297`*^9, 
  3.883674987178133*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"bdc2ff4d-6b63-4dfa-83f7-df24a311daf3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "\[CenterDot]", "x2", "\[CenterDot]", "n"}], "//.", 
  RowBox[{
   RowBox[{
    RowBox[{"a___", "\[CenterDot]", 
     RowBox[{"(", 
      RowBox[{"b_", "\[CenterDot]", "c_"}], ")"}], "\[CenterDot]", "d___"}], "/;", 
    RowBox[{"NumericQ", "[", "b", "]"}]}], ":>", 
   RowBox[{"b", " ", 
    RowBox[{"(", 
     RowBox[{"a", "\[CenterDot]", "c", "\[CenterDot]", "d"}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.88367499893256*^9, 3.8836750131792316`*^9}, {
   3.883675054632702*^9, 3.883675067607086*^9}, 3.883675175482071*^9},
 CellLabel->"In[5]:=",ExpressionUUID->"20cb127c-a7e6-4142-8958-f16c659cab4a"],

Cell[BoxData[
 RowBox[{"1", "\[CenterDot]", "x2", "\[CenterDot]", "n"}]], "Output",
 CellChangeTimes->{3.884681745971284*^9, 3.884795619783946*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"6ec88a95-69c8-48d3-b6d7-7b48fb8e56f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "\[CenterDot]", "x2", "\[CenterDot]", "n"}], "//", 
  "TreeForm"}]], "Input",
 CellChangeTimes->{{3.883675194274579*^9, 3.883675197013839*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"ebc9eb01-3ab2-4459-bcad-c3d2d9ec0423"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[
   TagBox[
    GraphicsComplexBox[{{0.7745966692414834, 0.7745966692414834}, {0., 0.}, {
     0.7745966692414834, 0.}, {1.5491933384829668`, 0.}}, {
      {RGBColor[0.55, 0.45, 0.45], LineBox[{{1, 2}, {1, 3}, {1, 4}}]}, {
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["CenterDot", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.05],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 1],
         TagBox[
          RowBox[{"1", "\[CenterDot]", "x2", "\[CenterDot]", "n"}], HoldForm]],
        Annotation[#, 
         HoldForm[
          CenterDot[1, $CellContext`x2, $CellContext`n]], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["1",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.05],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 2],
         TagBox["1", HoldForm]],
        Annotation[#, 
         HoldForm[1], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["x2",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.05],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 3],
         TagBox["x2", HoldForm]],
        Annotation[#, 
         HoldForm[$CellContext`x2], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["n",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.05],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 4],
         TagBox["n", HoldForm]],
        Annotation[#, 
         HoldForm[$CellContext`n], "Tooltip"]& ]}}],
    Annotation[#, 
     VertexCoordinateRules -> {{0.7745966692414834, 0.7745966692414834}, {0., 
      0.}, {0.7745966692414834, 0.}, {1.5491933384829668`, 0.}}]& ],
   AspectRatio->NCache[
     Rational[2, 3], 0.6666666666666666],
   FormatType:>StandardForm,
   FrameTicks->Automatic,
   PlotRange->All,
   PlotRangePadding->Scaled[0.1]],
  TreeForm[
   CenterDot[1, $CellContext`x2, $CellContext`n]],
  Editable->False]], "Output",
 CellChangeTimes->{3.88367519738118*^9, 3.884681747303706*^9},
 CellLabel->
  "Out[6]//TreeForm=",ExpressionUUID->"bc352993-ef1a-4860-a7c4-af8596b5aa86"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"3", " ", 
   RowBox[{"n", "\[CenterDot]", "x1"}], " ", 
   RowBox[{"1", "\[CenterDot]", "x2", "\[CenterDot]", "n"}]}], "//", 
  "TreeForm"}]], "Input",
 CellChangeTimes->{{3.883674331617865*^9, 3.883674333135942*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"fd78a5db-f195-4536-988e-8b92a3aadc8e"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[
   TagBox[
    GraphicsComplexBox[{{1.1939240115914183`, 1.3644845846759066`}, {0., 
     0.6822422923379533}, {0.6822422923379533, 0.6822422923379533}, {
     0.34112114616897665`, 0.}, {1.02336343850693, 0.}, {2.3878480231828365`, 
     0.6822422923379533}, {1.7056057308448833`, 0.}, {2.3878480231828365`, 
     0.}, {3.07009031552079, 0.}}, {
      {RGBColor[0.55, 0.45, 0.45], 
       LineBox[{{1, 2}, {1, 3}, {1, 6}, {3, 4}, {3, 5}, {6, 7}, {6, 8}, {6, 
        9}}]}, {
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["Times", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.042105263157894736`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 1],
         TagBox[
          RowBox[{"3", " ", 
            RowBox[{"n", "\[CenterDot]", "x1"}], " ", 
            RowBox[{"1", "\[CenterDot]", "x2", "\[CenterDot]", "n"}]}], 
          HoldForm]],
        Annotation[#, 
         HoldForm[
         3 CenterDot[$CellContext`n, $CellContext`x1] 
          CenterDot[1, $CellContext`x2, $CellContext`n]], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["3",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.042105263157894736`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 2],
         TagBox["3", HoldForm]],
        Annotation[#, 
         HoldForm[3], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["CenterDot", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.042105263157894736`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 3],
         TagBox[
          RowBox[{"n", "\[CenterDot]", "x1"}], HoldForm]],
        Annotation[#, 
         HoldForm[
          CenterDot[$CellContext`n, $CellContext`x1]], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["n",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.042105263157894736`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 4],
         TagBox["n", HoldForm]],
        Annotation[#, 
         HoldForm[$CellContext`n], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["x1",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.042105263157894736`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 5],
         TagBox["x1", HoldForm]],
        Annotation[#, 
         HoldForm[$CellContext`x1], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox["CenterDot", "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.042105263157894736`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 6],
         TagBox[
          RowBox[{"1", "\[CenterDot]", "x2", "\[CenterDot]", "n"}], HoldForm]],
        Annotation[#, 
         HoldForm[
          CenterDot[1, $CellContext`x2, $CellContext`n]], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["1",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.042105263157894736`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 7],
         TagBox["1", HoldForm]],
        Annotation[#, 
         HoldForm[1], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["x2",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.042105263157894736`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 8],
         TagBox["x2", HoldForm]],
        Annotation[#, 
         HoldForm[$CellContext`x2], "Tooltip"]& ], 
       TagBox[
        TooltipBox[InsetBox[
          FrameBox[
           StyleBox[
            TagBox["n",
             HoldForm], "StandardForm", "Output",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->Scaled[0.042105263157894736`],
            FontColor->GrayLevel[0]],
           Background->RGBColor[1., 1., 0.871],
           FrameStyle->GrayLevel[0.5],
           StripOnInput->False], 9],
         TagBox["n", HoldForm]],
        Annotation[#, 
         HoldForm[$CellContext`n], "Tooltip"]& ]}}],
    Annotation[#, 
     VertexCoordinateRules -> {{1.1939240115914183`, 1.3644845846759066`}, {
      0., 0.6822422923379533}, {0.6822422923379533, 0.6822422923379533}, {
      0.34112114616897665`, 0.}, {1.02336343850693, 0.}, {2.3878480231828365`,
       0.6822422923379533}, {1.7056057308448833`, 0.}, {2.3878480231828365`, 
      0.}, {3.07009031552079, 0.}}]& ],
   AspectRatio->NCache[Rational[6, 19]^Rational[1, 2], 0.5619514869490163],
   FormatType:>StandardForm,
   FrameTicks->Automatic,
   PlotRange->All,
   PlotRangePadding->Scaled[0.1]],
  TreeForm[
  3 CenterDot[$CellContext`n, $CellContext`x1] 
   CenterDot[1, $CellContext`x2, $CellContext`n]],
  Editable->False]], "Output",
 CellChangeTimes->{3.88468176213664*^9},
 CellLabel->
  "Out[8]//TreeForm=",ExpressionUUID->"aca3ad48-2cb6-4ecc-8b34-5db1f1bf7b54"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"projection", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"x1", "\[CenterDot]", "x2"}], "->", 
      RowBox[{
       RowBox[{
        SubscriptBox["x", "1"], 
        SubscriptBox["x", "2"]}], "+", 
       RowBox[{
        SubscriptBox["y", "1"], 
        SubscriptBox["y", "2"]}], "+", 
       RowBox[{
        SubscriptBox["z", "1"], 
        SubscriptBox["z", "2"]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x1", "\[CenterDot]", "x1"}], "->", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         SubscriptBox["x", "1"], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         SubscriptBox["y", "1"], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         SubscriptBox["z", "1"], ")"}], "2"]}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"x2", "\[CenterDot]", "x2"}], "->", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         SubscriptBox["x", "2"], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         SubscriptBox["y", "2"], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         SubscriptBox["z", "2"], ")"}], "2"]}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      SubscriptBox["x", "1"], "->", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["x", "2"], "->", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["y", "1"], "->", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["y", "2"], "->", "0"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projectionParallel", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "\[CenterDot]", "x1"}], "->", 
      SubscriptBox["z", "1"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "\[CenterDot]", "x2"}], "->", 
      SubscriptBox["z", "2"]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projectionPerpendicular", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "\[CenterDot]", "x1"}], "->", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "\[CenterDot]", "x2"}], "->", "0"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projectionTheta", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "\[CenterDot]", "x1"}], "->", 
      RowBox[{
       SubscriptBox["x", "1"], "c\[Theta]"}]}], " ", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "\[CenterDot]", "x2"}], "->", 
      RowBox[{
       SubscriptBox["x", "2"], "c\[Theta]"}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.865486994905381*^9, 3.865487174295423*^9}, {
  3.865487246201858*^9, 3.86548724637638*^9}, {3.871974664977936*^9, 
  3.871974674001004*^9}, {3.871975559812695*^9, 3.871975579460297*^9}, {
  3.871975615734127*^9, 3.871975627636346*^9}, {3.871983391430707*^9, 
  3.871983418579115*^9}, {3.884681773537623*^9, 3.884681785985257*^9}, {
  3.8846818225294847`*^9, 3.884681845105369*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"b14f98be-34a0-4879-9ed0-d71cc51909f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Potential", " ", 
     SubscriptBox["V", "w"], " ", "like", " ", 
     RowBox[{"1", "/", 
      SuperscriptBox["r", 
       RowBox[{"(", 
        RowBox[{"w", "+", "2"}], ")"}]]}], "\[IndentingNewLine]", "V"}], " ", 
    "=", " ", 
    RowBox[{
     RowBox[{
      SubscriptBox["V", "1"], "+", 
      SubscriptBox["V", "2"], "+", 
      SubscriptBox["V", "3"], "+"}], "..."}]}], "\[IndentingNewLine]", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"multipolarPotential", "[", "w_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["r", 
         RowBox[{"w", "+", "2"}]]], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"m", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"w", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", 
            FractionBox[
             RowBox[{"w", "+", "2"}], "2"], ",", 
            FractionBox[
             RowBox[{"w", "+", "1"}], "2"]}], "]"}]}], 
         RowBox[{"w", "+", "1"}]], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "m"], " ", 
         SuperscriptBox["2", 
          RowBox[{"m", "-", "w", "-", "1"}]], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "m"}], "-", "1"}], ")"}], "!!"}], " ", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"i", "=", "0"}], 
           RowBox[{"w", "+", "1", "-", "m"}]], 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"j", "=", "0"}], 
            RowBox[{"w", "+", "1", "-", "m", "-", "i"}]], 
           RowBox[{
            FractionBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "\[CenterDot]", "x1"}], ")"}], "i"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 RowBox[{"x1", "\[CenterDot]", "x2"}]}], ")"}], "j"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x2", "\[CenterDot]", "x2"}], ")"}], 
               RowBox[{"w", "+", "1", "-", "m", "-", "i", "-", "j"}]]}], 
             RowBox[{
              RowBox[{"i", "!"}], " ", 
              RowBox[{"j", "!"}], " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"w", "+", "1", "-", "m", "-", "i", "-", "j"}], ")"}], 
               "!"}]}]], " ", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"k", "=", "0"}], 
              RowBox[{
               RowBox[{"2", " ", "m"}], "-", "w", "-", "1"}]], 
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "\[CenterDot]", "n"}], ")"}], 
                RowBox[{
                 RowBox[{"2", " ", "m"}], "-", "w", "-", "1", "-", "k"}]], 
               " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "x2"}], "\[CenterDot]", "n"}], ")"}], "k"], 
               " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{
                  TemplateBox[{
                    RowBox[{"i", ",", 
                    RowBox[{"w", "+", "1", "-", "m"}]}]},
                   "KroneckerDeltaSeq"], " ", 
                  TemplateBox[{
                    RowBox[{"j", ",", "0"}]},
                   "KroneckerDeltaSeq"], " ", 
                  TemplateBox[{
                    RowBox[{"k", ",", "0"}]},
                   "KroneckerDeltaSeq"]}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{
                  TemplateBox[{
                    RowBox[{"i", ",", "0"}]},
                   "KroneckerDeltaSeq"], " ", 
                  TemplateBox[{
                    RowBox[{"j", ",", "0"}]},
                   "KroneckerDeltaSeq"], " ", 
                  TemplateBox[{
                    RowBox[{"k", ",", 
                    RowBox[{
                    RowBox[{"2", " ", "m"}], "-", "w", "-", "1"}]}]},
                   "KroneckerDeltaSeq"]}]}], ")"}]}], 
              RowBox[{
               RowBox[{"k", "!"}], " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", "m"}], "-", "w", "-", "1", "-", "k"}], 
                 ")"}], "!"}]}]]}]}]}]}]}]}]}], "//.", "\[VeryThinSpace]", 
      "rules"}], "//", "FullSimplify"}]}], "\n", 
   RowBox[{
    RowBox[{"multipolarPotentialProjectedPerpendicular", "[", "w_", "]"}], ":=", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"w", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", "0", ",", 
       RowBox[{
        FractionBox[
         RowBox[{" ", 
          RowBox[{"w", "!!"}]}], 
         SuperscriptBox["r", 
          RowBox[{"w", "+", "2"}]]], " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "0"}], 
          FractionBox[
           RowBox[{"w", "+", "1"}], "2"]], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "0"}], 
           RowBox[{
            FractionBox[
             RowBox[{"w", "+", "1"}], "2"], "-", "i"}]], 
          RowBox[{
           FractionBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{
               FractionBox[
                RowBox[{"w", "+", "1"}], "2"], "+", "j"}]], 
             SuperscriptBox["2", 
              RowBox[{
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"w", "+", "1"}], "2"]}], "+", "j"}]], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
                TemplateBox[{
                  RowBox[{"i", ",", 
                    FractionBox[
                    RowBox[{"w", "+", "1"}], "2"]}]},
                 "KroneckerDeltaSeq"], " ", 
                TemplateBox[{
                  RowBox[{"j", ",", "0"}]},
                 "KroneckerDeltaSeq"]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
                TemplateBox[{
                  RowBox[{"i", ",", "0"}]},
                 "KroneckerDeltaSeq"], " ", 
                TemplateBox[{
                  RowBox[{"j", ",", "0"}]},
                 "KroneckerDeltaSeq"]}]}], ")"}]}], 
            RowBox[{
             RowBox[{"i", "!"}], " ", 
             RowBox[{"j", "!"}], " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{"w", "+", "1"}], "2"], "-", "i", "-", "j"}], ")"}], 
              "!"}]}]], 
           SuperscriptBox[
            SubscriptBox["z", "1"], 
            RowBox[{
             RowBox[{"2", "i"}], "+", "j"}]], "  ", 
           SuperscriptBox[
            SubscriptBox["z", "2"], 
            RowBox[{"w", "+", "1", "-", 
             RowBox[{"2", "i"}], "-", "j"}]]}]}]}]}]}], "]"}], "//", 
     "FullSimplify"}]}], "\n", 
   RowBox[{
    RowBox[{"multipolarPotentialProjectedParallel", "[", "w_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       SuperscriptBox["r", 
        RowBox[{"w", "+", "2"}]]], 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"m", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"w", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", 
           FractionBox[
            RowBox[{"w", "+", "2"}], "2"], ",", 
           FractionBox[
            RowBox[{"w", "+", "1"}], "2"]}], "]"}]}], 
        RowBox[{"w", "+", "1"}]], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"i", "=", "0"}], 
         RowBox[{"w", "+", "1", "-", "m"}]], 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"j", "=", "0"}], 
          RowBox[{"w", "+", "1", "-", "m", "-", "i"}]], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"k", "=", "0"}], 
           RowBox[{
            RowBox[{"2", " ", "m"}], "-", "w", "-", "1"}]], 
          RowBox[{
           FractionBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], 
              RowBox[{"j", "+", "k", "+", "m"}]], 
             SuperscriptBox["2", 
              RowBox[{"m", "-", "w", "-", "1", "+", "j"}]], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "m"}], "-", "1"}], ")"}], "!!"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
                TemplateBox[{
                  RowBox[{"i", ",", 
                    RowBox[{"w", "+", "1", "-", "m"}]}]},
                 "KroneckerDeltaSeq"], " ", 
                TemplateBox[{
                  RowBox[{"j", ",", "0"}]},
                 "KroneckerDeltaSeq"], " ", 
                TemplateBox[{
                  RowBox[{"k", ",", "0"}]},
                 "KroneckerDeltaSeq"]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
                TemplateBox[{
                  RowBox[{"i", ",", "0"}]},
                 "KroneckerDeltaSeq"], " ", 
                TemplateBox[{
                  RowBox[{"j", ",", "0"}]},
                 "KroneckerDeltaSeq"], " ", 
                TemplateBox[{
                  RowBox[{"k", ",", 
                    RowBox[{
                    RowBox[{"2", " ", "m"}], "-", "w", "-", "1"}]}]},
                 "KroneckerDeltaSeq"]}]}], ")"}]}], 
            RowBox[{
             RowBox[{"i", "!"}], " ", 
             RowBox[{"j", "!"}], " ", 
             RowBox[{"k", "!"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"w", "+", "1", "-", "m", "-", "i", "-", "j"}], ")"}], 
              "!"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "m"}], "-", "w", "-", "1", "-", "k"}], 
               ")"}], "!"}]}]], 
           SuperscriptBox[
            SubscriptBox["z", "1"], 
            RowBox[{
             RowBox[{"2", "i"}], "+", "j", "+", 
             RowBox[{"2", " ", "m"}], "-", "w", "-", "1", "-", "k"}]], " ", 
           SuperscriptBox[
            SubscriptBox["z", "2"], 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{"w", "+", "1", "-", "m", "-", "i"}], ")"}]}], "-", "j",
              "+", "k"}]]}]}]}]}]}]}], "//", "FullSimplify"}]}]}]}]], "Input",\

 CellChangeTimes->{{3.871977083649438*^9, 3.871977164729113*^9}, {
   3.8719771952097387`*^9, 3.871977408428644*^9}, {3.8719774501084013`*^9, 
   3.8719775044456997`*^9}, {3.871977543573002*^9, 3.871977618308539*^9}, {
   3.871977680992722*^9, 3.871977767020034*^9}, {3.871978065069243*^9, 
   3.871978088269855*^9}, {3.8719783281081457`*^9, 3.871978348447345*^9}, {
   3.871978408452981*^9, 3.871978409498151*^9}, {3.87197855131632*^9, 
   3.8719785639687853`*^9}, {3.871978628218273*^9, 3.8719786306288548`*^9}, {
   3.871978702664832*^9, 3.871978707749004*^9}, {3.871978753108918*^9, 
   3.8719789517994957`*^9}, {3.8719838285094213`*^9, 3.8719838452586603`*^9}, 
   3.871984448367136*^9, {3.871984567530061*^9, 3.871984761230229*^9}, {
   3.8719848571635857`*^9, 3.8719849585611563`*^9}, {3.871985052330881*^9, 
   3.871985060661806*^9}, 3.871985434145092*^9, {3.8719855307519197`*^9, 
   3.8719855522716427`*^9}, {3.8719856573875628`*^9, 
   3.8719856783937483`*^9}, {3.87198572666481*^9, 3.8719858108920193`*^9}, {
   3.8719858758194733`*^9, 3.871985899714672*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"109120fd-ecc1-48f9-8183-0237c9a65f8e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"multipolarPotential", "[", "a", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "3"}], "}"}]}], "]"}], "//.", "rules"}], "//", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", "r", ",", " ", "Simplify"}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{
  3.8721509941226377`*^9, {3.872151050765082*^9, 3.872151069838377*^9}, {
   3.88367366279955*^9, 3.883673671924116*^9}, {3.883674310795663*^9, 
   3.8836743135578814`*^9}, {3.883674523004632*^9, 3.883674541464964*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"5949b977-7940-4d9d-971f-f23ff8ea1352"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", "3"}], " ", 
     RowBox[{"n", "\[CenterDot]", "x1"}], " ", 
     RowBox[{"n", "\[CenterDot]", "x2"}]}], "+", 
    RowBox[{"x1", "\[CenterDot]", "x2"}]}], 
   SuperscriptBox["r", "3"]], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", 
     SuperscriptBox["r", "4"]}]], 
   RowBox[{"3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"n", "\[CenterDot]", "x1"}], ")"}], "2"], " ", 
       RowBox[{"n", "\[CenterDot]", "x2"}]}], "-", 
      RowBox[{
       RowBox[{"n", "\[CenterDot]", "x2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x1", "\[CenterDot]", "x1"}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"x1", "\[CenterDot]", "x2"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"n", "\[CenterDot]", "x1"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "5"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"n", "\[CenterDot]", "x2"}], ")"}], "2"]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"x1", "\[CenterDot]", "x2"}]}], "+", 
         RowBox[{"x2", "\[CenterDot]", "x2"}]}], ")"}]}]}], ")"}]}]}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", " ", 
     SuperscriptBox["r", "5"]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "70"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"n", "\[CenterDot]", "x1"}], ")"}], "3"], " ", 
      RowBox[{"n", "\[CenterDot]", "x2"}]}], "-", 
     RowBox[{"15", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"n", "\[CenterDot]", "x2"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x1", "\[CenterDot]", "x1"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"x1", "\[CenterDot]", "x2"}]}]}], ")"}]}], "+", 
     RowBox[{"6", " ", 
      RowBox[{"x1", "\[CenterDot]", "x2"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"x1", "\[CenterDot]", "x1"}], ")"}]}], "+", 
        RowBox[{"x1", "\[CenterDot]", "x2"}]}], ")"}]}], "+", 
     RowBox[{"15", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"n", "\[CenterDot]", "x1"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"7", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"n", "\[CenterDot]", "x2"}], ")"}], "2"]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"x1", "\[CenterDot]", "x2"}]}], "-", 
        RowBox[{"x2", "\[CenterDot]", "x2"}]}], ")"}]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x1", "\[CenterDot]", "x1"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"x1", "\[CenterDot]", "x2"}]}]}], ")"}], " ", 
      RowBox[{"x2", "\[CenterDot]", "x2"}]}], "+", 
     RowBox[{"10", " ", 
      RowBox[{"n", "\[CenterDot]", "x1"}], " ", 
      RowBox[{"n", "\[CenterDot]", "x2"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "7"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"n", "\[CenterDot]", "x2"}], ")"}], "2"]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x1", "\[CenterDot]", "x1"}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"x1", "\[CenterDot]", "x2"}]}], "+", 
           RowBox[{"x2", "\[CenterDot]", "x2"}]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.872150994987071*^9, 3.872151016309787*^9}, {
   3.872151052561861*^9, 3.872151070117457*^9}, 3.883673604716385*^9, {
   3.8836736639541197`*^9, 3.883673672378483*^9}, 3.883673911034041*^9, 
   3.883674009081839*^9, 3.883674314166815*^9, {3.883674426280891*^9, 
   3.883674433789847*^9}, 3.883674488116234*^9, {3.883674525136307*^9, 
   3.883674541887259*^9}, 3.883674862193296*^9, 3.883675829602669*^9, 
   3.884681879880217*^9, 3.884795629188451*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"3e704bda-69f8-40c9-95bc-ab71b03882c5"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"expand", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"x1", "\[CenterDot]", "x2"}], "->", 
      RowBox[{
       RowBox[{"X1", " ", "X2"}], "+", 
       RowBox[{"Y1", " ", "Y2"}], "+", 
       RowBox[{"Z1", " ", "Z2"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x1", "\[CenterDot]", "x1"}], "->", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", "X1", ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", "Y1", ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", "Z1", ")"}], "2"]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x2", "\[CenterDot]", "x2"}], "->", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", "X2", ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", "Y2", ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", "Z2", ")"}], "2"]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a___", "\[CenterDot]", "n", "\[CenterDot]", "x1"}], "->", 
      RowBox[{"a", "\[CenterDot]", "Z1"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a___", "\[CenterDot]", "n", "\[CenterDot]", "x2"}], "->", 
      RowBox[{"a", "\[CenterDot]", "Z2"}]}]}], "\[IndentingNewLine]", "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTheta", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"x1", "\[CenterDot]", "x2"}], "->", 
      RowBox[{"X1", " ", "X2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x1", "\[CenterDot]", "x1"}], "->", 
      SuperscriptBox[
       RowBox[{"(", "X1", ")"}], "2"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x2", "\[CenterDot]", "x2"}], "->", 
      SuperscriptBox[
       RowBox[{"(", "X2", ")"}], "2"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a___", "\[CenterDot]", "n", "\[CenterDot]", "x1"}], "->", 
      RowBox[{"c\[Theta]", " ", 
       RowBox[{"a", "\[CenterDot]", "X1"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a___", "\[CenterDot]", "n", "\[CenterDot]", "x2"}], "->", 
      RowBox[{"c\[Theta]", " ", 
       RowBox[{"a", "\[CenterDot]", "X2"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.88367375547921*^9, 3.883673765531217*^9}, {
  3.883674567469962*^9, 3.883674670203244*^9}, {3.883675299543618*^9, 
  3.883675300315827*^9}, {3.883675613609524*^9, 3.883675628063307*^9}, {
  3.883675698210083*^9, 3.883675788475582*^9}, {3.884681908722364*^9, 
  3.884681922386751*^9}, {3.884681953138809*^9, 3.884681976978471*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"26043a93-df55-4769-bd71-ff4ffbbb57c5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", 
       RowBox[{"n", "\[CenterDot]", "x1"}], " ", 
       RowBox[{"n", "\[CenterDot]", "x2"}]}], "+", 
      RowBox[{"x1", "\[CenterDot]", "x2"}]}], 
     SuperscriptBox["r", "3"]], "//.", "expandTheta"}], "//.", "rules"}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.883676658143648*^9, 3.8836766746519823`*^9}, {
  3.88468198513764*^9, 3.8846819859052258`*^9}, {3.884682100398403*^9, 
  3.884682104388317*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"dc0bba12-bcf9-44ae-bee9-7151b2503559"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["c\[Theta]", "2"]}]}], ")"}], " ", "X1", " ", "X2"}], 
  SuperscriptBox["r", "3"]]], "Output",
 CellChangeTimes->{{3.883676669772273*^9, 3.883676674957451*^9}, 
   3.8846819889819927`*^9, {3.884682101216359*^9, 3.884682104788315*^9}, 
   3.88479563275036*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"5c9c5f1c-b142-4688-b550-2fd7cdbe84df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["c\[Theta]", "2"]}]}], ")"}], "//.", 
     RowBox[{"c\[Theta]", "->", 
      RowBox[{"1", "+", "\[Epsilon]"}]}]}], "//", 
    RowBox[{
     RowBox[{"CoefficientList", "[", 
      RowBox[{"#", ",", "\[Epsilon]"}], "]"}], "&"}]}], ")"}], "[", 
  RowBox[{"[", 
   RowBox[{";;", "2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8847956422996187`*^9, 3.884795730542207*^9}, {
  3.884795832280937*^9, 3.884795834210672*^9}, {3.884795912179021*^9, 
  3.884795913739955*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"d561ad10-41ce-4366-b169-dd65d8300b6d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "6"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.884795673182466*^9, 3.884795730732183*^9}, 
   3.884795835033277*^9, 3.884795914104488*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"23eeb6ee-bb14-471f-aeec-ce8210319166"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", " ", 
       SuperscriptBox["r", "4"]}]], 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"5", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"n", "\[CenterDot]", "x1"}], ")"}], "2"], " ", 
         RowBox[{"n", "\[CenterDot]", "x2"}]}], "-", 
        RowBox[{
         RowBox[{"n", "\[CenterDot]", "x2"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x1", "\[CenterDot]", "x1"}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"x1", "\[CenterDot]", "x2"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"n", "\[CenterDot]", "x1"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "5"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"n", "\[CenterDot]", "x2"}], ")"}], "2"]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"x1", "\[CenterDot]", "x2"}]}], "+", 
           RowBox[{"x2", "\[CenterDot]", "x2"}]}], ")"}]}]}], ")"}]}]}], "//.",
     "expandTheta"}], "//.", "rules"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.883674549982151*^9, 3.8836745562887077`*^9}, {
   3.8836758524002647`*^9, 3.883675860435508*^9}, 3.8846820024992523`*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"6cd8d3af-ffa4-4dfb-96fb-fedb7cd272d8"],

Cell[BoxData[
 FractionBox[
  RowBox[{"3", " ", "c\[Theta]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "3"}], "+", 
     RowBox[{"5", " ", 
      SuperscriptBox["c\[Theta]", "2"]}]}], ")"}], " ", "X1", " ", 
   RowBox[{"(", 
    RowBox[{"X1", "-", "X2"}], ")"}], " ", "X2"}], 
  RowBox[{"2", " ", 
   SuperscriptBox["r", "4"]}]]], "Output",
 CellChangeTimes->{{3.883675854769438*^9, 3.883675862327579*^9}, 
   3.884682003490664*^9, 3.884795742872137*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"cc83c69a-7daf-4b71-afb9-575720070db2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"3", " ", "c\[Theta]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "3"}], "+", 
         RowBox[{"5", " ", 
          SuperscriptBox["c\[Theta]", "2"]}]}], ")"}]}], "2"], "//.", 
     RowBox[{"c\[Theta]", "->", 
      RowBox[{"1", "+", "\[Epsilon]"}]}]}], "//", 
    RowBox[{
     RowBox[{"CoefficientList", "[", 
      RowBox[{"#", ",", "\[Epsilon]"}], "]"}], "&"}]}], ")"}], "[", 
  RowBox[{"[", 
   RowBox[{";;", "2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.884795754523877*^9, {3.884795842341497*^9, 3.884795845757872*^9}, {
   3.884795880218354*^9, 3.884795887851138*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"20f4a97d-4d4f-4cd6-a26c-73c1045f2ae0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "18"}], "}"}]], "Output",
 CellChangeTimes->{3.8847957550189238`*^9, 3.884795846190114*^9, 
  3.884795888132681*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"552f42ed-ce28-471d-b041-813966ff32c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "X1", " ", "X2"}], "+", 
      SuperscriptBox["X2", "2"], "+", 
      RowBox[{"Y2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "Y1"}], "+", "Y2"}], ")"}]}]}], ")"}], " ",
     "Z1"}], "-", 
   RowBox[{"3", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["X1", "2"], "-", 
      RowBox[{"2", " ", "X1", " ", "X2"}], "+", 
      SuperscriptBox["Y1", "2"], "-", 
      RowBox[{"2", " ", "Y1", " ", "Y2"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["Z1", "2"]}]}], ")"}], " ", "Z2"}], "-", 
   RowBox[{"6", " ", "Z1", " ", 
    SuperscriptBox["Z2", "2"]}]}], "//", "Expand"}]], "Input",
 CellChangeTimes->{{3.883676574164455*^9, 3.883676576336034*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"3f1ee4ce-f4d6-4579-81ce-64ce141ec48a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "6"}], " ", "X1", " ", "X2", " ", "Z1"}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["X2", "2"], " ", "Z1"}], "-", 
  RowBox[{"6", " ", "Y1", " ", "Y2", " ", "Z1"}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["Y2", "2"], " ", "Z1"}], "-", 
  RowBox[{"3", " ", 
   SuperscriptBox["X1", "2"], " ", "Z2"}], "+", 
  RowBox[{"6", " ", "X1", " ", "X2", " ", "Z2"}], "-", 
  RowBox[{"3", " ", 
   SuperscriptBox["Y1", "2"], " ", "Z2"}], "+", 
  RowBox[{"6", " ", "Y1", " ", "Y2", " ", "Z2"}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["Z1", "2"], " ", "Z2"}], "-", 
  RowBox[{"6", " ", "Z1", " ", 
   SuperscriptBox["Z2", "2"]}]}]], "Output",
 CellChangeTimes->{3.883676576684463*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"922ccb26-7281-4e64-b7ae-104499dd5983"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"4", " ", 
       SuperscriptBox["r", "5"]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "70"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"n", "\[CenterDot]", "x1"}], ")"}], "3"], " ", 
        RowBox[{"n", "\[CenterDot]", "x2"}]}], "-", 
       RowBox[{"15", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"n", "\[CenterDot]", "x2"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x1", "\[CenterDot]", "x1"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"x1", "\[CenterDot]", "x2"}]}]}], ")"}]}], "+", 
       RowBox[{"6", " ", 
        RowBox[{"x1", "\[CenterDot]", "x2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"x1", "\[CenterDot]", "x1"}], ")"}]}], "+", 
          RowBox[{"x1", "\[CenterDot]", "x2"}]}], ")"}]}], "+", 
       RowBox[{"15", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"n", "\[CenterDot]", "x1"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"7", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"n", "\[CenterDot]", "x2"}], ")"}], "2"]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"x1", "\[CenterDot]", "x2"}]}], "-", 
          RowBox[{"x2", "\[CenterDot]", "x2"}]}], ")"}]}], "+", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x1", "\[CenterDot]", "x1"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"x1", "\[CenterDot]", "x2"}]}]}], ")"}], " ", 
        RowBox[{"x2", "\[CenterDot]", "x2"}]}], "+", 
       RowBox[{"10", " ", 
        RowBox[{"n", "\[CenterDot]", "x1"}], " ", 
        RowBox[{"n", "\[CenterDot]", "x2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "7"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"n", "\[CenterDot]", "x2"}], ")"}], "2"]}], "+", 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x1", "\[CenterDot]", "x1"}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"x1", "\[CenterDot]", "x2"}]}], "+", 
             RowBox[{"x2", "\[CenterDot]", "x2"}]}], ")"}]}]}], ")"}]}]}], 
      ")"}]}], "//.", "expandTheta"}], "//.", "rules"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.883675892986038*^9, 3.883675899792616*^9}, 
   3.8846820149949617`*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"390c33e0-00af-4c1c-b85f-00dfe668a779"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"3", "-", 
      RowBox[{"30", " ", 
       SuperscriptBox["c\[Theta]", "2"]}], "+", 
      RowBox[{"35", " ", 
       SuperscriptBox["c\[Theta]", "4"]}]}], ")"}], " ", "X1", " ", "X2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["X1", "2"]}], "-", 
      RowBox[{"3", " ", "X1", " ", "X2"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["X2", "2"]}]}], ")"}]}], 
   RowBox[{"4", " ", 
    SuperscriptBox["r", "5"]}]]}]], "Output",
 CellChangeTimes->{3.883675900530302*^9, 3.884682016359355*^9, 
  3.884795763736829*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"d369a9eb-ad00-4f1c-b089-f43a4b024f33"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"3", "-", 
           RowBox[{"30", " ", 
            SuperscriptBox["c\[Theta]", "2"]}], "+", 
           RowBox[{"35", " ", 
            SuperscriptBox["c\[Theta]", "4"]}]}], ")"}], " "}], "4"]}], "//.", 
      RowBox[{"c\[Theta]", "->", 
       RowBox[{"1", "+", "\[Epsilon]"}]}]}], "//", 
     RowBox[{
      RowBox[{"CoefficientList", "[", 
       RowBox[{"#", ",", "\[Epsilon]"}], "]"}], "&"}]}], "//", 
    "FullSimplify"}], ")"}], "[", 
  RowBox[{"[", 
   RowBox[{";;", "2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.884795771930879*^9, 3.8847957774589252`*^9}, {
  3.884795863840548*^9, 3.8847958665783043`*^9}, {3.88479589795505*^9, 
  3.884795899506109*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"4365c90a-1ce6-4a77-8eff-7a112167a80e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "20"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.884795772466424*^9, 3.884795777727536*^9}, 
   3.884795867500753*^9, 3.8847958998905973`*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"341d83eb-2d60-45e4-89f7-250b3a33590c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        SuperscriptBox["X1", "3"], " ", "X2"}], "+", 
       RowBox[{"Y1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["X2", "2"], " ", "Y1"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["X2", "2"], "+", 
             SuperscriptBox["Y1", "2"]}], ")"}], " ", "Y2"}], "+", 
          RowBox[{"3", " ", "Y1", " ", 
           SuperscriptBox["Y2", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["Y2", "3"]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["X1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           SuperscriptBox["X2", "2"]}], "+", 
          RowBox[{"Y2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "Y1"}], "+", "Y2"}], ")"}]}]}], 
         ")"}]}], "-", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["X2", "2"], "+", 
          RowBox[{"Y2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "Y1"}], "+", "Y2"}], ")"}]}]}], ")"}], 
        " ", 
        SuperscriptBox["Z1", "2"]}], "-", 
       RowBox[{"2", " ", "X1", " ", "X2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["X2", "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Y1", "-", "Y2"}], ")"}], "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["Z1", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"8", " ", "Z1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"X1", "-", "X2"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Y1", "-", "Y2"}], ")"}], "2"]}], ")"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["Z1", "2"]}]}], ")"}], " ", "Z2"}], "-", 
    RowBox[{"12", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["X1", "2"], "-", 
       RowBox[{"2", " ", "X1", " ", "X2"}], "+", 
       SuperscriptBox["Y1", "2"], "-", 
       RowBox[{"2", " ", "Y1", " ", "Y2"}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["Z1", "2"]}]}], ")"}], " ", 
     SuperscriptBox["Z2", "2"]}], "-", 
    RowBox[{"16", " ", "Z1", " ", 
     SuperscriptBox["Z2", "3"]}]}], ")"}], "//", "Expand"}]], "Input",
 CellChangeTimes->{{3.8836764820931387`*^9, 3.88367648423783*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"9ff313c8-f6d1-40dc-8c4d-9894da1f6a3d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", "6"}], " ", 
    SuperscriptBox["X1", "3"], " ", "X2"}], "+", 
   RowBox[{"9", " ", 
    SuperscriptBox["X1", "2"], " ", 
    SuperscriptBox["X2", "2"]}], "-", 
   RowBox[{"6", " ", "X1", " ", 
    SuperscriptBox["X2", "3"]}], "-", 
   RowBox[{"6", " ", "X1", " ", "X2", " ", 
    SuperscriptBox["Y1", "2"]}], "+", 
   RowBox[{"3", " ", 
    SuperscriptBox["X2", "2"], " ", 
    SuperscriptBox["Y1", "2"]}], "-", 
   RowBox[{"6", " ", 
    SuperscriptBox["X1", "2"], " ", "Y1", " ", "Y2"}], "+", 
   RowBox[{"12", " ", "X1", " ", "X2", " ", "Y1", " ", "Y2"}], "-", 
   RowBox[{"6", " ", 
    SuperscriptBox["X2", "2"], " ", "Y1", " ", "Y2"}], "-", 
   RowBox[{"6", " ", 
    SuperscriptBox["Y1", "3"], " ", "Y2"}], "+", 
   RowBox[{"3", " ", 
    SuperscriptBox["X1", "2"], " ", 
    SuperscriptBox["Y2", "2"]}], "-", 
   RowBox[{"6", " ", "X1", " ", "X2", " ", 
    SuperscriptBox["Y2", "2"]}], "+", 
   RowBox[{"9", " ", 
    SuperscriptBox["Y1", "2"], " ", 
    SuperscriptBox["Y2", "2"]}], "-", 
   RowBox[{"6", " ", "Y1", " ", 
    SuperscriptBox["Y2", "3"]}], "+", 
   RowBox[{"24", " ", "X1", " ", "X2", " ", 
    SuperscriptBox["Z1", "2"]}], "-", 
   RowBox[{"12", " ", 
    SuperscriptBox["X2", "2"], " ", 
    SuperscriptBox["Z1", "2"]}], "+", 
   RowBox[{"24", " ", "Y1", " ", "Y2", " ", 
    SuperscriptBox["Z1", "2"]}], "-", 
   RowBox[{"12", " ", 
    SuperscriptBox["Y2", "2"], " ", 
    SuperscriptBox["Z1", "2"]}], "+", 
   RowBox[{"24", " ", 
    SuperscriptBox["X1", "2"], " ", "Z1", " ", "Z2"}], "-", 
   RowBox[{"48", " ", "X1", " ", "X2", " ", "Z1", " ", "Z2"}], "+", 
   RowBox[{"24", " ", 
    SuperscriptBox["X2", "2"], " ", "Z1", " ", "Z2"}], "+", 
   RowBox[{"24", " ", 
    SuperscriptBox["Y1", "2"], " ", "Z1", " ", "Z2"}], "-", 
   RowBox[{"48", " ", "Y1", " ", "Y2", " ", "Z1", " ", "Z2"}], "+", 
   RowBox[{"24", " ", 
    SuperscriptBox["Y2", "2"], " ", "Z1", " ", "Z2"}], "-", 
   RowBox[{"16", " ", 
    SuperscriptBox["Z1", "3"], " ", "Z2"}], "-", 
   RowBox[{"12", " ", 
    SuperscriptBox["X1", "2"], " ", 
    SuperscriptBox["Z2", "2"]}], "+", 
   RowBox[{"24", " ", "X1", " ", "X2", " ", 
    SuperscriptBox["Z2", "2"]}], "-", 
   RowBox[{"12", " ", 
    SuperscriptBox["Y1", "2"], " ", 
    SuperscriptBox["Z2", "2"]}], "+", 
   RowBox[{"24", " ", "Y1", " ", "Y2", " ", 
    SuperscriptBox["Z2", "2"]}], "+", 
   RowBox[{"24", " ", 
    SuperscriptBox["Z1", "2"], " ", 
    SuperscriptBox["Z2", "2"]}], "-", 
   RowBox[{"16", " ", "Z1", " ", 
    SuperscriptBox["Z2", "3"]}]}], "//.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Y1", "->", "0"}], ",", 
    RowBox[{"Z1", "->", "0"}], ",", 
    RowBox[{"Y2", "->", "0"}], ",", 
    RowBox[{"Z2", "->", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.88367714702099*^9, 3.883677189591783*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"f2b6ba53-fe3c-4198-baa9-994ebf3f9b1b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "6"}], " ", 
   SuperscriptBox["X1", "3"], " ", "X2"}], "+", 
  RowBox[{"9", " ", 
   SuperscriptBox["X1", "2"], " ", 
   SuperscriptBox["X2", "2"]}], "-", 
  RowBox[{"6", " ", "X1", " ", 
   SuperscriptBox["X2", "3"]}]}]], "Output",
 CellChangeTimes->{3.883677190454946*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"01b0336b-caec-435f-a199-c1f312ff8b55"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", "6"}], " ", 
     SuperscriptBox["X1", "3"], " ", "X2"}], "+", 
    RowBox[{"9", " ", 
     SuperscriptBox["X1", "2"], " ", 
     SuperscriptBox["X2", "2"]}], "-", 
    RowBox[{"6", " ", "X1", " ", 
     SuperscriptBox["X2", "3"]}]}], 
   RowBox[{"4", " ", 
    SuperscriptBox["r", "5"]}]], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.883677224512871*^9, 3.883677234398954*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"b5f2246d-0f45-483f-892f-ed20bbfa8473"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"3", " ", "X1", " ", "X2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["X1", "2"]}], "-", 
      RowBox[{"3", " ", "X1", " ", "X2"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["X2", "2"]}]}], ")"}]}], 
   RowBox[{"4", " ", 
    SuperscriptBox["r", "5"]}]]}]], "Output",
 CellChangeTimes->{3.88367723468824*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"6e3cb7b0-9458-432d-9246-90fce1ca02df"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{760, 847},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.35 Inherited,
FrontEndVersion->"12.3 for Mac OS X ARM (64-bit) (September 30, 2021)",
StyleDefinitions->"maTHEMEatica.nb",
ExpressionUUID->"cbfc67cf-7b6d-4815-b114-22fa0f2eefe9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 164, 3, 132, "Title",ExpressionUUID->"baff7555-b9e6-4628-8fdd-8b769f1a5051"],
Cell[747, 27, 370, 9, 41, "Input",ExpressionUUID->"47f5daae-a3d8-4104-aae2-b42a037d0857"],
Cell[1120, 38, 711, 19, 70, "Input",ExpressionUUID->"73f1a499-2fd8-4b0b-8930-d61041b097ff"],
Cell[1834, 59, 2666, 60, 210, "Input",ExpressionUUID->"bdc2ff4d-6b63-4dfa-83f7-df24a311daf3"],
Cell[CellGroupData[{
Cell[4525, 123, 652, 15, 41, "Input",ExpressionUUID->"20cb127c-a7e6-4142-8958-f16c659cab4a"],
Cell[5180, 140, 225, 3, 65, "Output",ExpressionUUID->"6ec88a95-69c8-48d3-b6d7-7b48fb8e56f3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5442, 148, 260, 5, 41, "Input",ExpressionUUID->"ebc9eb01-3ab2-4459-bcad-c3d2d9ec0423"],
Cell[5705, 155, 3554, 97, 362, "Output",ExpressionUUID->"bc352993-ef1a-4860-a7c4-af8596b5aa86"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9296, 257, 330, 7, 41, "Input",ExpressionUUID->"fd78a5db-f195-4536-988e-8b92a3aadc8e"],
Cell[9629, 266, 7745, 204, 312, "Output",ExpressionUUID->"aca3ad48-2cb6-4ecc-8b34-5db1f1bf7b54"]
}, Open  ]],
Cell[17389, 473, 3344, 93, 608, "Input",ExpressionUUID->"b14f98be-34a0-4879-9ed0-d71cc51909f9"],
Cell[20736, 568, 12153, 323, 718, "Input",ExpressionUUID->"109120fd-ecc1-48f9-8183-0237c9a65f8e"],
Cell[CellGroupData[{
Cell[32914, 895, 666, 15, 41, "Input",ExpressionUUID->"5949b977-7940-4d9d-971f-f23ff8ea1352"],
Cell[33583, 912, 4120, 115, 294, "Output",ExpressionUUID->"3e704bda-69f8-40c9-95bc-ab71b03882c5"]
}, Open  ]],
Cell[37718, 1030, 2714, 65, 418, "Input",ExpressionUUID->"26043a93-df55-4769-bd71-ff4ffbbb57c5"],
Cell[CellGroupData[{
Cell[40457, 1099, 631, 16, 94, "Input",ExpressionUUID->"dc0bba12-bcf9-44ae-bee9-7151b2503559"],
Cell[41091, 1117, 462, 11, 71, "Output",ExpressionUUID->"5c9c5f1c-b142-4688-b550-2fd7cdbe84df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41590, 1133, 708, 19, 44, "Input",ExpressionUUID->"d561ad10-41ce-4366-b169-dd65d8300b6d"],
Cell[42301, 1154, 304, 7, 65, "Output",ExpressionUUID->"23eeb6ee-bb14-471f-aeec-ce8210319166"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42642, 1166, 1427, 38, 157, "Input",ExpressionUUID->"6cd8d3af-ffa4-4dfb-96fb-fedb7cd272d8"],
Cell[44072, 1206, 545, 14, 71, "Output",ExpressionUUID->"cc83c69a-7daf-4b71-afb9-575720070db2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44654, 1225, 785, 22, 106, "Input",ExpressionUUID->"20f4a97d-4d4f-4cd6-a26c-73c1045f2ae0"],
Cell[45442, 1249, 244, 5, 46, "Output",ExpressionUUID->"552f42ed-ce28-471d-b041-813966ff32c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45723, 1259, 939, 27, 104, "Input",ExpressionUUID->"3f1ee4ce-f4d6-4579-81ce-64ce141ec48a"],
Cell[46665, 1288, 814, 20, 75, "Output",ExpressionUUID->"922ccb26-7281-4e64-b7ae-104499dd5983"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47516, 1313, 2692, 74, 240, "Input",ExpressionUUID->"390c33e0-00af-4c1c-b85f-00dfe668a779"],
Cell[50211, 1389, 735, 21, 71, "Output",ExpressionUUID->"d369a9eb-ad00-4f1c-b089-f43a4b024f33"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50983, 1415, 931, 26, 139, "Input",ExpressionUUID->"4365c90a-1ce6-4a77-8eff-7a112167a80e"],
Cell[51917, 1443, 307, 7, 46, "Output",ExpressionUUID->"341d83eb-2d60-45e4-89f7-250b3a33590c"]
}, Open  ]],
Cell[52239, 1453, 2824, 83, 197, "Input",ExpressionUUID->"9ff313c8-f6d1-40dc-8c4d-9894da1f6a3d"],
Cell[CellGroupData[{
Cell[55088, 1540, 2925, 77, 238, "Input",ExpressionUUID->"f2b6ba53-fe3c-4198-baa9-994ebf3f9b1b"],
Cell[58016, 1619, 405, 11, 46, "Output",ExpressionUUID->"01b0336b-caec-435f-a199-c1f312ff8b55"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58458, 1635, 551, 15, 66, "Input",ExpressionUUID->"b5f2246d-0f45-483f-892f-ed20bbfa8473"],
Cell[59012, 1652, 496, 14, 71, "Output",ExpressionUUID->"6e3cb7b0-9458-432d-9246-90fce1ca02df"]
}, Open  ]]
}, Open  ]]
}
]
*)

