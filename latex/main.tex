\documentclass[reprint, amsmath, amssymb, aps]{revtex4-2}

\usepackage{graphicx}
\graphicspath{{./assets/figures/}}
\usepackage{dcolumn}
\usepackage{bm}
\usepackage{diagbox}
\usepackage[table]{xcolor}
\usepackage{hyperref}
\usepackage{comment}
\newcolumntype{L}{>{$}l<{$}} % math-mode version of "l" column type
\usepackage{float} % To fix location of tables with H
\usepackage[ruled,vlined]{algorithm2e}
\usepackage{braket}
\usepackage{amsthm}
\usepackage{cleveref}
\usepackage{mathtools}
\usepackage{listings} % to add python code

\newtheorem{definition}{Definition}
\newtheorem{prop}{Proposition}
\DeclareMathOperator{\tr}{Tr}

\begin{document}

\preprint{}

\title{Simulating Quantum Drude Oscillators on a photonic quantum computer}
%\thanks{}

\author{Matthieu Sarkis}
\email{matthieu.sarkis@uni.lu}
\affiliation{
Department of Physics and Materials Science\\ University of Luxembourg, L-1511, Luxembourg City, Luxembourg.
}

\author{}
\email{}
\affiliation{
}

%\collaboration{}%\noaffiliation

\date{\today}

\begin{abstract}
%\begin{description}
%\item[Usage]
%Secondary publications and information retrieval purposes.
%\item[Structure]
%You may use the \texttt{description} environment to structure your abstract;
%use the optional argument of the \verb+\item+ command to give the category of each item.
%\end{description}
\end{abstract}

%\keywords{Suggested keywords}%Use showkeys class option if keyword
                              %display desired
\maketitle

%\tableofcontents


\section{Introduction}

    We work in atomic units, for which $m_e=q_e=\hbar=\frac{1}{4\pi\epsilon_0}=1$.

    Dispersion forces, also known as van der Waals (vdW) forces originate from the electromagnetic interaction between electrically neutral atoms or molecules which do not have permanent electric moments \cite{margenau2013theory,kaplan2006intermolecular,stone2013theory,hirschfelder2009intermolecular}. They are ever-present long-range forces between atoms or molecules arising from the zero-point fluctuations of the quantum electromagnetic field \cite{casimir1948influence,buhmann2013dispersion,buhmann2007dispersion,compagno1995atom,passante2018dispersion}. Their importance can be appreciated on both macro- and micro-scales; for instance, the first macroscopic signature of dispersion forces is the well-known correction to the equation of state of an ideal gas that led to the van der Waals equation \cite{milonni2013quantum}. Moreover, dispersion forces also influence the structure of liquids and solids such as the anomalies of water \cite{schmid2001recent} as well as the macroscopic properties of macromolecules such as their structure \cite{hoja2019reliable}, stability \cite{hoja2018first,mortazavi2018structure}, dynamics \cite{stohr2019quantum,reilly2014role,galante2021anisotropic}, and electric \cite{kleshchonok2018tailoring} and optical \cite{ambrosetti2022optical} responses. The most natural framework for the investigation of the response of matter subjected to such forces is quantum electrodynamics \cite{cohen1997photons,cohen1998atom,bookpreparata,salam2009molecular,craig1998t}. However, as widely shown in the literature, the inclusion of vdW dispersion interactions can be done by means of many-body methods \cite{richardson1975dispersion,mahanty1973dispersion,woods2016materials,tkatchenko2015current,ren2012random,harl2009accurate,dobson2012calculation,parsegian2005van}. Dispersion vdW interactions are often represented within the Lennard-Jones approach, namely, through a pairwise two-body interatomic potential \cite{becke2006simple,becke2006exchange,grimme2010consistent,grimme2006semiempirical,tkatchenko2012accurate,massa2021many} of the form $C_{6}/R^{6}$ (where $R$ is the interatomic distance and $C_6$ a system-dependent constant). Among all the existing models in the literature, the many-body dispersion (MBD) framework has been undoubtedly proved to be an accurate approach \cite{tkatchenko2012accurate,ambrosetti2014long}. In the MBD framework, the electronic response of valence electrons in atoms and molecules is supposed to be linear and this can be formally done through the introduction of the quantum Drude oscillator (QDO). A single QDO is coarse-grained quantum-mechanical model in which the properties of an atom are encompassed in a small number of parameters. The model consists in assimilating the atom to a point particle of mass $m$ and electric charge $-q$ attached to a fixed (infinite mass) center of charge $+q$ by a harmonic spring characterized by a frequency $\omega$. Molecules are then defined as a collection of QDOs in dipole-dipole interaction.
    For some specific choices of the matter system geometry, the quantum Hamiltonian can be exactly diagonalized. For instance, in a closed linear chain of molecules, one can analytically solve for the spectrum of the Hamiltonion \cite{doi:10.1063/1.1743992}. In the case of a general geometry, instead, one can solve for the London-van der Waals interaction energy through a perturbative approach \cite{doi:10.1063/1.1743991}.
    This simple model has been extensively used in various contexts, for instance in order to tackle the electronic structure problem for isolated molecules, in particular long range interactions, as well as to study the impact of an ambient bath or of an external electric field on molecular properties \cite{Karimpour_2022, karimpour2021comprehensive}.
    Though simple, through a numerical treatment this system was shown to capture long-range phenomena in large biomolecular systems \cite{https://doi.org/10.48550/arxiv.2205.11549}. By construction, the MBD framework relies on the dipole approximation of the electronâ€“electron Coulomb interaction leaving aside any contribution coming from high-order terms. In the literature, dispersion forces have been addressed mostly for atomic dimers and small systems, via multipolar generalizations of the pairwise second-order perturbative approaches \cite{massa2021beyond,massa2021many,becke2006simple,becke2006exchange}.
    In this Letter ...


\section{Definition of the model}

    \subsection{Three-dimensional model}

        The Hamiltonian describing a system of $N$ QDOs in 3d is given by:
        \begin{equation}
        \label{eq:full_QDO_Hamiltonian}
            H_{(3,3)}=\sum_{i=1}^N\left[\frac{\bm{p} _i^2}{2m_i} + \frac{1}{2}m_i\omega_i^2\bm{x} _i^2\right] +\sum_{i<j}V_\text{Coul}\left(\bm{x} _i, \bm{x} _j\right)\,,
        \end{equation}
        with the Coulomb interaction receiving contributions from every pair of constituents (centers and point particles):
        \begin{equation*}
        \label{eq:full_coulomb_potential}
        \mathclap{
            \frac{V_\text{Coul}\left(\bm{x} _i, \bm{x} _j\right)}{q_iq_j}=\frac{1}{r_{ij}} - \frac{1}{|\bm{r}_{ij}  + \bm{x} _i|} - \frac{1}{|\bm{r}_{ij}  - \bm{x} _j|} + \frac{1}{|\bm{r}_{ij} - \bm{x} _j + \bm{x} _i|}
        }
        \end{equation*}
        The subscript (3,3) in the above definition will become clear soon.
        In terms of components, the full Coulomb potential reads:
        \begin{equation}
        \mathclap{
        \begin{split}
            &\frac{V_\text{Coul}(\bm{x} _i, \bm{x} _j)}{q_iq_j} = \frac{1}{r_{ij}} - \frac{1}{\sqrt{r_{ij}^2 + x_i^2+y_i^2+z_i^2+2rz_i}} \\
            &- \frac{1}{\sqrt{r_{ij}^2 + x_j^2+y_j^2+z_j^2-2r_{ij}z_j}} \\
            &+\frac{1}{\sqrt{r_{ij}^2 + (x_j-x_i)^2+(y_j-y_i)^2+(z_j-z_i)^2-2r_{ij}(z_j-z_i)}}
        \end{split}
        }
        \end{equation}
        In the multipolar expansion, this can be expressed as a power series in the inverse distance separating the two centers:
        \begin{equation}
            V_\text{Coul}\left(\bm{x} _i, \bm{x} _j\right)= \sum_{n\geq 0} V_n\left(\bm{x} _i, \bm{x} _j\right)\,,
        \end{equation}
        with the following scaling behavior in terms of the distance between the centers:
        \begin{equation}
            V_n\left(\bm{x} _i, \bm{x} _j\right)\propto r_{ij}^{-n-3}\,.
        \end{equation}
        The potential $V_0$ corresponds then to the dipole-dipole interaction, $V_1$ to the dipole-quadrupole interaction, and $V_2$ to the quadrupole-quadrupole and dipole-octupole interaction.
        Let us give here the expression for the multipolar potential up to quartic order:
        \begin{align}
            V_0(\bm{x} _i, \bm{x} _j) &= q_iq_j\frac{x_ix_j + y_iy_j - z_iz_j}{r_{ij}^3}\\
            V_1(\bm{x} _i, \bm{x} _j) &= \frac{q_iq_j}{2r_{ij}^4}\big(-3  x_i ^2  z_j -6  x_i   x_j   z_i +6  x_i   x_j   z_j +3  x_j ^2  z_i\nonumber\\
            & -3  y_i ^2  z_j -6  y_i   y_j   z_i +6  y_i   y_j   z_j +3  y_j ^2  z_i\nonumber\\
            & +6  z_i ^2  z_j -6  z_i   z_j ^2\big)\\
            V_2(\bm{x} _i, \bm{x} _j) &= \frac{q_iq_j}{2 r_{ij}^4}\big(-6  x_i ^3  x_j +9  x_i ^2  x_j ^2-6  x_i ^2  y_i   y_j +3  x_i ^2  y_j ^2\nonumber\\
            &+24  x_i ^2  z_i   z_j -12  x_i ^2  z_j ^2-6  x_i   x_j ^3-6  x_i   x_j   y_i ^2\nonumber\\
            &+12  x_i   x_j   y_i   y_j -6  x_i   x_j   y_j ^2+24  x_i   x_j   z_i ^2\nonumber\\
            &-48  x_i   x_j   z_i   z_j +24  x_i   x_j   z_j ^2+3  x_j ^2  y_i ^2-6  x_j ^2  y_i   y_j \nonumber\\
            &-12  x_j ^2  z_i ^2+24  x_j ^2  z_i   z_j -6  y_i ^3  y_j +9  y_i ^2  y_j ^2\nonumber\\
            &+24  y_i ^2  z_i   z_j -12  y_i ^2  z_j ^2-6  y_i   y_j ^3+24  y_i   y_j   z_i ^2\nonumber\\
            &-48  y_i   y_j   z_i   z_j +24  y_i   y_j   z_j ^2-12  y_j ^2  z_i ^2+24  y_j ^2  z_i   z_j \nonumber\\
            &-16  z_i ^3  z_j +24  z_i ^2  z_j ^2-16  z_i   z_j ^3\big)
        \end{align}
        We define the dimensionless position and momenta associated to QDO $i$:
        \begin{equation}
            \bm{X}_i := \sqrt{\frac{m_i\omega_i}{\hbar}}\,\bm{x}_i\,,\ \ \ \ \ \bm{P}_i := \frac{\bm{p}_i}{\sqrt{2\hbar m_i\omega_i}}\,,
        \end{equation}
        in terms of which the $3N$ creation and annihilation operators read ($\alpha=1,2,3$)
        \begin{equation}
            \bm a_{i} = \frac{\bm X_{i} + i\bm P_{i}}{\sqrt 2}\,,\ \ \ \ \ \bm a^\dagger_{i} = \frac{\bm X_{i} - i\bm P_{i}}{\sqrt 2}\,.
        \end{equation}
        In terms of the dimensionless canonical variables, the Hamiltonian reads
        \begin{equation}
        \begin{split}
            H_{(3,3)} &= \sum_{i=1}^N\frac{\hbar\omega_i}{2}\left(\bm X_{i}^2 + \bm P_{i}^2\right) \\
            & + \sum_{i<j}V_\text{Coul}\left(\sqrt{\frac{\hbar}{m_i\omega_i}}\bm{X} _i, \sqrt{\frac{\hbar}{m_j\omega_j}}\bm{X} _j\right)
        \end{split}
        \end{equation}
        and can be rewritten
        \begin{equation}
        \begin{split}
            H_{(3,3)} &= \sum_{i=1}^N\frac{\hbar\omega_i}{2}\left(\bm a_{i}^\dagger\cdot\bm a_{i} +\frac{3}{2}\right) \\
            & + \sum_{i<j}V_\text{Coul}\left(\sqrt{\frac{\hbar}{m_i\omega_i}}\frac{\bm a_i + \bm a_i^\dagger}{\sqrt 2}, \sqrt{\frac{\hbar}{m_j\omega_j}}\frac{\bm a_j + \bm a_j^\dagger}{\sqrt 2}\right)
        \end{split}
        \end{equation}
    \subsection{One-dimensional case}

        Let us define one-dimensional instances of the QDO model as follows: we restrict the movement of the two electrons to be along a common axis (directed by a unit vector $\hat{\bm e}_\theta$) which form an angle $\theta$ with respect to the vector $\bm r_{ij}$ connecting the two nuclei. As particular cases, we obtain models in which the electrons are constrained to move either in the direction parallel to the axis separating the two nuclei ($\theta=0$), or perpendicular to the latter ($\theta=\pi/2$). We therefore have a family of one-dimensional models which can be obtained from the full-fledged 3d model simply by setting to zero the contribution from the oscillator modes belonging to the plane perpendicular to $\hat{\bm e}_\theta$. Let us denote by $x$ the remaining degree of freedom. As will be explained in the results section, one particular model will prove relevant, the so-called \textit{space regularized model}, in which the angle $\theta$ is chosen to be infinitesimally small $\theta=\epsilon\ll 1$.
        \begin{equation}
        \begin{split}
            &V_0(x_i, x_j) = q_iq_j\frac{x_ix_j}{r_{ij}^3}\times\\
            &\times\begin{cases}
                1-3\cos^2\theta, & \text{generic case} \\
                -2, & \text{parallel case} \\
                1, & \text{perpendicular case} \\
                -\frac{1}{2}, & \text{oblique case} \\
                -2-6\epsilon, & \text{regularized case}
            \end{cases}
        \end{split}
        \end{equation}
        The next terms in the multipolar expansion are:
        \begin{equation}
        \begin{split}
            &V_1(x_i, x_j) = q_iq_j\frac{x_ix_j(x_i-x_j)}{r_{ij}^4}\times\\
            &\times\begin{cases}
                \frac{3\cos\theta(-3+5\cos^2\theta)}{2}, & \text{generic case} \\
                3, & \text{parallel case} \\
                0, & \text{perpendicular case} \\
                -\frac{3}{4\sqrt 2}, & \text{oblique case} \\
                3+18\epsilon, & \text{regularized case}
            \end{cases}
        \end{split}
        \end{equation}
        \begin{equation}
            \begin{split}
                &V_2(x_i, x_j) = q_iq_j\frac{x_ix_j(2x_i^2-3x_ix_j+2x_j^2)}{r_{ij}^5}\times\\
                &\times
                \begin{cases}
                    -\frac{3-30\cos^2\theta+35\cos^4\theta}{4}, & \text{generic case} \\
                    -2, & \text{parallel case} \\
                    -\frac{3}{4}, & \text{perpendicular case} \\
                    \frac{13}{16}, & \text{oblique case} \\
                    -2-20\epsilon, & \text{regularized case}
                \end{cases}
            \end{split}
        \end{equation}
        For the full Coulomb potential, assuming that the electrons are constrained to move along an axis, we get the following expressions:
        \begin{equation}
        \begin{split}
            \frac{V_\text{Coul}^\perp(x_i, x_j)}{q_iq_j} = &\ \frac{1}{r_{ij}} - \frac{1}{\sqrt{r_{ij}^2+x_i^2}} - \frac{1}{\sqrt{r_{ij}^2+x_j^2}} \\
            &+\frac{1}{\sqrt{r_{ij}^2 + (x_j-x_i)^2}}
        \end{split}
        \end{equation}
        in the case where the electrons move perpendicular to the axis joining the two nuclei, and
        \begin{equation*}
        \mathclap{
            \frac{V_\text{Coul}^{||}(x_i, x_j)}{q_iq_j} = \frac{1}{r_{ij}} - \frac{1}{|r_{ij}+x_i|} - \frac{1}{|r_{ij}-x_j|} + \frac{1}{|r_{ij}+x_i-x_j|}
        }
        \end{equation*}
        in the case where they move parallel to the latter. In the case of a generic angle $\theta$ between $\bm r_{ij}$ and $\bm x_i$/$\bm x_j$, one has
        \begin{equation}
        \begin{split}
            &\frac{V_\text{Coul}^\theta(x_i, x_j)}{q_iq_j} = \frac{1}{r_{ij}} - \frac{1}{\sqrt{r_{ij}^2+2r_{ij}(\cos\theta) x_i+x_i^2}} \\
            &- \frac{1}{\sqrt{r_{ij}^2-2r_{ij}(\cos\theta) x_j+x_j^2}} \\
            &+\frac{1}{\sqrt{r_{ij}^2 - 2r_{ij}(\cos\theta) (x_j-x_i) + (x_j-x_i)^2}}\,.
        \end{split}
        \end{equation}
        The space regularized model Coulomb potential reads
        \begin{equation}
        \begin{split}
            &\frac{V_\text{Coul}^\epsilon(x_i, x_j)}{q_iq_j} = \frac{1}{r_{ij}} - \frac{1}{\sqrt{r_{ij}^2+2r_{ij}(1+\epsilon) x_i+x_i^2}} \\
            &- \frac{1}{\sqrt{r_{ij}^2-2r_{ij}(1+\epsilon) x_j+x_j^2}} \\
            &+\frac{1}{\sqrt{r_{ij}^2 - 2r_{ij}(1+\epsilon) (x_j-x_i) + (x_j-x_i)^2}}\,.
        \end{split}
        \end{equation}

    \subsection{12 different models}

        For the simulation, we will restrict the system to two QDOs. Depending on the space dimensionality (1d oblique, 1d parallel, 1d perpendicular, 3d) and the choice of potential (quadratic, quartic, Coulomb), we therefore have 12 models to try and study, gathered in table (\ref{tab:models}).
        \begin{table}[ht!]
        \caption{\label{tab:models} The twelve models}
        \begin{ruledtabular}
        \begin{tabular}{c|cccc}
            \diagbox[height=1.8\line]{\textsc{pot}}{\textsc{dim}}& 1d oblique & 1d parallel & 1d perpendicular & 3d \\
            \hline\\[-0.95em]
            \textsc{quad} & $H_{(1,0)}$ & $H_{(1,1)}$ & $H_{(1,2)}$ & $H_{(1,3)}$ \\
            \textsc{quart} & $H_{(2,0)}$ & $H_{(2,1)}$ & $H_{(2,2)}$ & $H_{(2,3)}$\\
            \textsc{Coulomb} & $H_{(3,0)}$ & $H_{(3,1)}$ & $H_{(3,2)}$ & $H_{(3,3)}$ \\
        \end{tabular}
        \end{ruledtabular}
        \end{table}

\section{Photonic circuit}

    The circuit implements a unitary $U(\theta)$ acting on an input reference state (the Fock vacuum for instance) that we simply take to be the vacuum state $|0\rangle$. The state prepared by the circuit is therefore given by
    \begin{equation}
        |\psi(\theta)\rangle = U(\theta)|0\rangle\,.
    \end{equation}

    In the dipolar approximation, namely for the Hamiltonians $H_{(1,1)}$, $H_{(1,2)}$ and $H_{(1,3)}$, we expect that using a Gaussian state would be enough. The circuit is therefore composed of at most quadratic optical components (squeezing operations for our ansatz). However for the other models,  non-Gaussian operation should be added in the end of each layer in the ansatz circuit.

    One the ansatz state $|\psi(\theta)\rangle$ has been produced, one should extract the value of the energy in that state, namely compute the value of
    \begin{equation}
        \langle\psi(\theta)|H|\psi(\theta)\rangle
    \end{equation}
    To be specific, let us take the model $H_{(3,3)}$, and let us denote by angular brackets the expectation in state $|\psi(\theta)\rangle$. One has
    \begin{equation}
    \label{eq:loss}
    \begin{split}
        &\langle H_{(3,3)}\rangle = \sum_{i=1}^N\frac{\hbar\omega_i}{2}\left(\langle n_{i,x}\rangle+\langle n_{i,y}\rangle+\langle n_{i,z}\rangle+\frac{3}{2}\right)\\
        &+ \sum_{i<j}\left\langle V_\text{Coul}\left(\sqrt{\frac{\hbar}{m_i\omega_i}}\bm X_i, \sqrt{\frac{\hbar}{m_j\omega_j}}\bm X_j\right)\right\rangle
    \end{split}
    \end{equation}
    by linearity of the expectation. On the second line one has to compute something of the form $\langle f(X_{i,\alpha})\rangle$, where $(X_{i,\alpha})$ denotes collectively the position quadrature of all the photon channels (including QDO and spatial index). One therefore needs to extract the statistics of quadratures by preparing and measuring the state $|\psi(\theta)\rangle$ in the quadrature basis. Once the joint density $\rho$ of $(X_{i,\alpha})$ in the state $|\psi(\theta)\rangle$ is known, one can compute
    \begin{equation}
        \langle f(X_{i,\alpha})\rangle = \int_{\mathbb R^{3N}}f(x_{i,\alpha})\rho(x_{i,\alpha})\prod_{i,\alpha}\text{d}x_{i,\alpha}\,.
    \end{equation}
    There is a complication related to the fact that strawberryfields does not allow to access the joint law of the position quadratures. We therefore have to extract it by ourselves. Let us first suppose that there are $K$ photon modes. The statevector is represented in the Fock basis as follows:
    \begin{equation}
        |\psi\rangle = \sum_{n_1,\dots,n_{2K}=0}^\infty \alpha_{n_1\dots n_{2K}}|n_1\rangle\otimes\dots\otimes|n_{2K}\rangle\,.
    \end{equation}
    The modes labeled by $(n_1,\dots,n_K)$ correspond to $\text{QDO}_1$, while the modes $(n_{K+1},\dots,n_{2K})$ are attached to $\text{QDO}_2$.
    The amplitude of a specific tuple of the quadratures $(X_1,\dots, X_{K})$ is therefore given by:
    \begin{equation*}
    \mathclap{
        \langle X_1,\dots,X_{2K}|\psi\rangle = \sum_{n_1,\dots,n_{2K}=0}^\infty \alpha_{n_1\dots n_{2K}}\prod_{i=1}^{2K}\frac{e^{-\sum_{i=1}^{2K}\frac{X_i^2}{2}}H_{n_i}(X_i)}{\sqrt{\pi^{1/2}2^{n_i}n_i!}}\,,
    }
    \end{equation*}
    in terms of the Hermite polynomials. The joint law of the quadratures in the state $|\psi\rangle$ is therefore given by
    \begin{equation}
    \begin{split}
        \rho(X_1,\dots,X_{2K}) &= \sum_{\substack{n_1,\dots,n_{2K} \\ m_1,\dots,m_{2K}}} \alpha_{n_1\dots n_{2K}}\alpha^*_{m_1\dots m_{2K}}\\
        &\times\prod_{i=1}^{2K}\frac{e^{-X_i^2}H_{n_i}(X_i)H_{m_i}(X_i)}{\sqrt{\pi^{1/2}2^{n_i}n_i!}\sqrt{\pi^{1/2}2^{m_i}m_i!}}
    \end{split}
    \end{equation}
    Notice that the tensor $\alpha_{n_1,\dots,n_{2K}}$ is precisely the output of `state.ket()` in strawberryfields.
    Also the Hermite polynomials are implemented in `scipy.special.hermite`:
    \begin{lstlisting}[language=Python]
    from scipy import special
    p = special.hermite(3, monic=False)
    \end{lstlisting}

    After extracting as well the mean photon numbers $\langle n_{i,\alpha}\rangle$, one obtains $\langle H_{(3,3)}\rangle$.

\section{Variational algorithm}

    Depending on the model $H_{(\mu,\nu)}$ of interest, we define the following loss function:
    \begin{equation}
        \mathcal C_{(\mu,\nu)}(\theta) := \langle\psi(\theta)|H_{(\mu,\nu)}|\psi(\theta)\rangle
    \end{equation}
    In order to compute this loss, one therefore has to measure both the photon number operator on each channel, as well as the position quadrature operator on each channel, as described in the previous section.
    \newpage

    \begin{algorithm}
        \caption{Extract distribution of observable}\label{alg:statistics_computation}
            \textbf{Parameters:} statevector $|\psi\rangle$, observable $\mathcal O$, shots $M\in\mathbb N$

            \KwResult{Probability distribution of $\mathcal O$ in state $|\psi\rangle$}\

            \For{$m=1$ to $\dim(\text{spec}(\mathcal O))$}{
                Initialize $N_m \gets 0$;
            }
            \For{$j=1$ to $M$}{
            Measure the state $|\psi$ in the basis $\mathcal O$, obtain the eigenvalue $o_m$, set $N_m\gets N_m+1$\;
            }
            \For{$m=1$ to $\dim(\text{spec}(\mathcal O))$}{
                Normalize $N_m \gets N_m / M$;
            }
            \textbf{return} $(N_m)_m$.
    \end{algorithm}

    \begin{algorithm}
        \caption{Computation of the loss}\label{alg:loss_computation}
            \textbf{Parameters:} $M\in\mathbb N$

            \KwResult{Value of the loss $\mathcal C$}\

            Initialize $\mathcal C \gets 0$\;
            Get the position quadratures distribution with alg. (\ref{alg:statistics_computation})\;
            Get the photon numbers distribution with alg. (\ref{alg:statistics_computation})\;
            Compute the loss $\mathcal C$ using eq. (\ref{eq:loss})\;
            \textbf{return} $\mathcal C$.
    \end{algorithm}

    \begin{algorithm}
        \caption{Training of the parameterized photonic circuit}\label{alg:training}
        \textbf{Parameters:} $N_\text{steps}\in\mathbb N$, initial parameters $\theta_0\in\mathbb R^K$, learning rate $\eta\in\mathbb R_+$

        \KwResult{Optimized hyperparameters $\theta\in\mathbb R^K$}\

        Initialize hyperparameters $\theta \gets \theta_0$\;
        \For{$i=1$ to $N_\text{steps}$}{
        Compute the loss $\mathcal C$ with alg. (\ref{alg:loss_computation})\;
        Compute the gradient $\nabla_\theta\mathcal C$ with shift rule and alg. (\ref{alg:loss_computation})\;
            Update the parameters $\theta \gets \theta - \eta\nabla_\theta\mathcal C$\;
        \textbf{end for}
        }
        \textbf{return} $\theta$.
    \end{algorithm}

\section{Results}
    We gather here the results of the simulations. We focus on the case of 2 QDOs. In particular we plot the profile of the binding energy as a function of the distance between the two nuclei. The binding energy is simply defined as the ground state energy of the interacting system to which one substract the ground state energy of the uninteracting system, namely that of a pair of free harmonic oscillators in this Drude model.

\section{Quantum mutual information}

    Let us give the expression of the partial densitity matrix associated to $\text{QDO}_1$. The total state of the system, we recall, is expressed in the Fock basis as
    \begin{equation}
        |\psi\rangle = \sum_{n_1,\dots,n_{2K}=0}^\infty \alpha_{n_1\dots n_{2K}}|n_1\rangle\otimes\dots\otimes|n_{2K}\rangle\,,
    \end{equation}
    leading to the following expression for the density matrix:
    \begin{equation*}
    \mathclap{
        \rho = \sum_{\substack{n_1,\dots,n_{2K} \\ m_1,\dots,m_{2K}}} \alpha^*_{m_1\dots m_{2K}}\alpha_{n_1\dots n_{2K}}|n_1\rangle\langle m_1|\otimes\dots\otimes|n_{2K}\rangle\langle m_{2K}|\,.
    }
    \end{equation*}
    The partial trace associated to $\text{QDO}_1$ is therefore given by:
    \begin{equation}
    \begin{split}
        \rho_1 = \sum_{\substack{n_1,\dots,n_{K} \\ m_1,\dots,m_{K} \\ l_1,\dots,l_{K}}}& \alpha^*_{m_1\dots m_{K}l_1,\dots,l_{K}}\alpha_{n_1\dots n_{K}l_1,\dots,l_{K}}\\
        &|n_1\rangle\langle m_1|\otimes\dots\otimes|n_{K}\rangle\langle m_{K}|\,.
    \end{split}
    \end{equation}
    Since the state of the total system is pure, the von Neumann entropy of the total density matrix is zero. QDO number 2 can then be interpreted as purifying the system composed solely of QDO number 1. The two QDO therefore have identical von Neumann entropy $S(\rho_1)$, the entanglement entropy. The quantum mutual information of the system is therefore given by
    \begin{equation}
        I(1:2) = S(\rho_1) + S(\rho_2) - S(\rho) = 2S(\rho_1) \,,
    \end{equation}
    with the von Neumann entropy being defined as
    \begin{equation}
        S(\rho) = -\text{Tr}\rho\log\rho\,.
    \end{equation}
    The profile of the quantum mutual information as a function of the interatomic distance is provided in fig. (...)

\section{Conclusion}

\begin{acknowledgments}

\end{acknowledgments}

\section*{Code Availability}

The reader will find an open source python code accompanying this paper at \href{https://github.com/MatthieuSarkis/qdo}{github repository}.

\appendix

\nocite{*}
\bibliographystyle{IEEEtran}
\bibliography{bibliography}

\end{document}